# Система интерактивного обучения

В проекте внедрена система интерактивного обучения с использованием библиотеки Intro.js для помощи пользователям в освоении интерфейса приложения. Система предназначена для ролей «партнер» и «клиент».

## Общие сведения

Система обучения автоматически запускает туры (интерактивные подсказки) при первом посещении пользователем определенных страниц. Также пользователь может вручную запустить тур с помощью кнопки помощи в правом нижнем углу экрана.

## Структура системы

1. **Клиентская часть**:
   - `resources/js/tours.js` - основная логика туров
   - `resources/sass/app.scss` - стили для туров
   - `resources/views/components/help-tour-button.blade.php` - компонент кнопки помощи

2. **Серверная часть**:
   - `app/Http/Controllers/TourController.php` - API для работы с турами
   - `app/Models/UserCompletedTour.php` - модель для хранения информации о пройденных турах
   - `database/migrations/2025_06_27_000000_create_user_completed_tours_table.php` - миграция для таблицы туров

## Доступные туры

Система содержит следующие туры:

### Для партнеров:
1. **dashboard** - главная страница панели партнера
2. **project** - страница управления проектом
3. **project-files** - страница файлов проекта
4. **estimates** - страница смет проекта

### Для клиентов:
1. **dashboard** - главная страница панели клиента
2. **project** - страница просмотра проекта
3. **estimates** - страница смет проекта

## Добавление новых туров

Для добавления новых туров необходимо выполнить следующие шаги:

1. **Добавить определение тура в `resources/js/tours.js`**:
```javascript
// Пример создания нового тура
const newTour = [
    {
        intro: 'Добро пожаловать на новую страницу!'
    },
    {
        element: '.some-element-selector',
        intro: 'Это описание элемента',
        position: 'right'
    }
];

// Добавить тур в словарь туров
tours['partner']['new-page-key'] = newTour;
```

2. **Обновить функцию определения страниц в файле `resources/js/app.js`**:
```javascript
function detectCurrentPageAndInitTour() {
    // ...existing code...
    
    if (path.includes('/partner')) {
        // ...existing code...
        } else if (path.match(/\/partner\/new-page$/)) {
            pageKey = 'new-page-key';
        }
    }
    
    // ...existing code...
}
```

3. **Добавить необходимые data-атрибуты к HTML-элементам**:
```html
<div class="some-element-selector">Содержимое</div>
```

## Как работать с системой

### Проверка наличия туров для пользователя

```php
// В контроллере
$user = Auth::user();
$hasTourCompleted = $user->hasTourCompleted('tour_partner_dashboard');
```

### Сброс истории просмотра туров

```php
// В контроллере
UserCompletedTour::where('user_id', $user->id)->delete();
```

## Рекомендации по созданию туров

1. **Краткость** - удерживайте внимание пользователя, делая подсказки короткими и информативными
2. **Последовательность** - выстраивайте подсказки в логическом порядке
3. **Контекст** - показывайте туры только там, где они действительно необходимы
4. **Ненавязчивость** - пользователь всегда должен иметь возможность пропустить тур

## Применение миграции

Если таблица для хранения информации о турах не была создана автоматически, выполните команду:

```
php artisan tours:migrate
```

## Отладка

В случае проблем с работой туров проверьте следующее:

1. Консоль браузера на наличие ошибок JavaScript
2. Правильность селекторов элементов в определении туров
3. Логи Laravel на предмет ошибок при сохранении информации о турах
